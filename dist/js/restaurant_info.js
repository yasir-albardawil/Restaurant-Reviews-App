var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()}),initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnVhbW1hciIsImEiOiJjanZtZGw0Z2QxODFnNDNsMnV5Nm5qb3piIn0.DQlJK9ZS67myAqvmvs8ODg",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})},fetchRestaurantFromURL=function(a){if(self.restaurant)a(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurantById(e,function(e,t){(self.restaurant=t)?(fillRestaurantHTML(),a(null,t)):console.error(e)}):(error="No restaurant id in URL",a(error,null))}},fillRestaurantHTML=function(e){var t=0<arguments.length&&void 0!==e?e:self.restaurant,a=document.getElementById("restaurant-name");a.setAttribute("aria-label",t.name),a.innerHTML=t.name;var n=document.getElementById("restaurant-address");n.setAttribute("aria-label",t.address),n.innerHTML=t.address;var r=document.getElementById("restaurant-img");r.className="restaurant-img",r.src=DBHelper.imageUrlForRestaurant(t),r.alt="Restaurant image ".concat(t.name);var i=document.getElementById("restaurant-cuisine");i.setAttribute("aria-label",t.cuisine_type),i.innerHTML=t.cuisine_type,t.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(e){var t=0<arguments.length&&void 0!==e?e:self.restaurant.operating_hours,a=document.getElementById("restaurant-hours");for(var n in a.setAttribute("aria-label","Restaurant hours"),t){var r=document.createElement("tr"),i=document.createElement("td");i.setAttribute("aria-label",n),i.innerHTML=n,r.appendChild(i);var l=document.createElement("td");l.innerHTML=t[n],r.appendChild(l),a.appendChild(r)}},fillReviewsHTML=function(e){var t=0<arguments.length&&void 0!==e?e:self.restaurant.reviews,a=document.getElementById("reviews-container"),n=document.createElement("h2");if(n.setAttribute("aria-label","Reviews"),n.innerHTML="Reviews",a.appendChild(n),!t){var r=document.createElement("p");return r.setAttribute("aria-label","No reviews yet!"),r.innerHTML="No reviews yet!",void a.appendChild(r)}var i=document.getElementById("reviews-list");t.forEach(function(e){i.appendChild(createReviewHTML(e))}),a.appendChild(i)},createReviewHTML=function(e){var t=document.createElement("li"),a=document.createElement("p");a.setAttribute("aria-label",e.name),a.innerHTML=e.name,t.appendChild(a);var n=document.createElement("p");n.innerHTML=e.date,n.setAttribute("aria-label",e.date),t.appendChild(n);var r=document.createElement("p");r.setAttribute("aria-label","Rating: ".concat(e.rating)),r.innerHTML="Rating: ".concat(e.rating),t.appendChild(r);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(e){var t=0<arguments.length&&void 0!==e?e:self.restaurant,a=document.getElementById("breadcrumb"),n=document.createElement("li");n.setAttribute("aria-label",t.name),n.innerHTML=t.name,a.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null};